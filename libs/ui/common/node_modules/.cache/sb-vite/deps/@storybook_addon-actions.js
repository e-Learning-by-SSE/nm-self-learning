import {
  ImplicitActionsDuringRendering,
  v4_default
} from "./chunk-6SAYOUT5.js";
import "./chunk-DPULHH3L.js";
import {
  require_global
} from "./chunk-K6L44BO6.js";
import {
  require_preview_api
} from "./chunk-76P27JAH.js";
import {
  __toESM
} from "./chunk-WGAPYIUP.js";

// ../../../node_modules/@storybook/addon-actions/dist/chunk-WFFRPTHA.mjs
var import_preview_api = __toESM(require_preview_api(), 1);
var import_global = __toESM(require_global(), 1);
var PARAM_KEY = "actions";
var ADDON_ID = "storybook/actions";
var PANEL_ID = `${ADDON_ID}/panel`;
var EVENT_ID = `${ADDON_ID}/action-event`;
var CLEAR_ID = `${ADDON_ID}/action-clear`;
var CYCLIC_KEY = "$___storybook.isCyclic";
var config = { depth: 10, clearOnStoryChange: true, limit: 50 };
var configureActions = (options = {}) => {
  Object.assign(config, options);
};
var findProto = (obj, callback) => {
  let proto = Object.getPrototypeOf(obj);
  return !proto || callback(proto) ? proto : findProto(proto, callback);
};
var isReactSyntheticEvent = (e) => !!(typeof e == "object" && e && findProto(e, (proto) => /^Synthetic(?:Base)?Event$/.test(proto.constructor.name)) && typeof e.persist == "function");
var serializeArg = (a) => {
  if (isReactSyntheticEvent(a)) {
    let e = Object.create(a.constructor.prototype, Object.getOwnPropertyDescriptors(a));
    e.persist();
    let viewDescriptor = Object.getOwnPropertyDescriptor(e, "view"), view = viewDescriptor == null ? void 0 : viewDescriptor.value;
    return typeof view == "object" && (view == null ? void 0 : view.constructor.name) === "Window" && Object.defineProperty(e, "view", { ...viewDescriptor, value: Object.create(view.constructor.prototype) }), e;
  }
  return a;
};
var generateId = () => typeof crypto == "object" && typeof crypto.getRandomValues == "function" ? v4_default() : Date.now().toString(36) + Math.random().toString(36).substring(2);
function action(name, options = {}) {
  let actionOptions = { ...config, ...options }, handler = function(...args) {
    var _a, _b;
    if (options.implicit) {
      let storyRenderer = (_a = "__STORYBOOK_PREVIEW__" in import_global.global ? import_global.global.__STORYBOOK_PREVIEW__ : void 0) == null ? void 0 : _a.storyRenders.find((render) => render.phase === "playing" || render.phase === "rendering");
      if (storyRenderer) {
        let deprecated = !((_b = window == null ? void 0 : window.FEATURES) == null ? void 0 : _b.disallowImplicitActionsInRenderV8), error = new ImplicitActionsDuringRendering({ phase: storyRenderer.phase, name, deprecated });
        if (deprecated)
          console.warn(error);
        else
          throw error;
      }
    }
    let channel = import_preview_api.addons.getChannel(), id = generateId(), minDepth = 5, serializedArgs = args.map(serializeArg), normalizedArgs = args.length > 1 ? serializedArgs : serializedArgs[0], actionDisplayToEmit = { id, count: 0, data: { name, args: normalizedArgs }, options: { ...actionOptions, maxDepth: minDepth + (actionOptions.depth || 3), allowFunction: actionOptions.allowFunction || false } };
    channel.emit(EVENT_ID, actionDisplayToEmit);
  };
  return handler.isAction = true, handler;
}
var actions = (...args) => {
  let options = config, names = args;
  names.length === 1 && Array.isArray(names[0]) && ([names] = names), names.length !== 1 && typeof names[names.length - 1] != "string" && (options = { ...config, ...names.pop() });
  let namesObject = names[0];
  (names.length !== 1 || typeof namesObject == "string") && (namesObject = {}, names.forEach((name) => {
    namesObject[name] = name;
  }));
  let actionsObject = {};
  return Object.keys(namesObject).forEach((name) => {
    actionsObject[name] = action(namesObject[name], options);
  }), actionsObject;
};
export {
  ADDON_ID,
  CLEAR_ID,
  CYCLIC_KEY,
  EVENT_ID,
  PANEL_ID,
  PARAM_KEY,
  action,
  actions,
  config,
  configureActions
};
//# sourceMappingURL=@storybook_addon-actions.js.map
